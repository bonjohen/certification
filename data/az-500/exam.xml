<?xml version="1.0" encoding="UTF-8"?>
<certification-exam xmlns="http://certification.study/schema/v1" version="1.0">
  <metadata>
    <exam-code>AZ-500</exam-code>
    <exam-title>Microsoft Azure Security Technologies</exam-title>
    <provider>Microsoft</provider>
    <description>Scenario-Based Study Companion for AZ-500 certification - validates expertise in implementing security controls, maintaining security posture, managing identity and access, and protecting data, applications, and networks in Azure.</description>
    <total-questions>50</total-questions>
    <created-date>2026-01-20</created-date>
    <last-modified>2026-01-20T00:00:00Z</last-modified>
    <categories>
      <category id="cat-identity">Identity and Access Management</category>
      <category id="cat-network">Network Security</category>
      <category id="cat-compute">Compute and Application Security</category>
      <category id="cat-data">Data and Storage Security</category>
      <category id="cat-operations">Security Operations</category>
    </categories>
  </metadata>

  <questions>
    <question id="1" category-ref="cat-identity" difficulty="advanced">
      <title>Conditional Access Attack Scenarios</title>
      <scenario>Your organization experienced a credential stuffing attack where compromised credentials from another breach were used. Attackers logged in from unusual locations but passed MFA using push notification fatigue.</scenario>
      <question-text>Which Conditional Access configurations would have prevented this attack?</question-text>
      <choices>
        <choice letter="A">Require number matching for MFA and block legacy authentication</choice>
        <choice letter="B">Require MFA for all users without additional controls</choice>
        <choice letter="C">Allow trusted locations only</choice>
        <choice letter="D">Require compliant devices only</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Number matching prevents MFA fatigue attacks by requiring users to enter a displayed number.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Number matching requires users to enter a number displayed on the sign-in screen into the Authenticator app, preventing blind approval of push notifications. Blocking legacy authentication prevents protocols that don't support MFA. Together, these stop credential stuffing with MFA fatigue.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>MFA fatigue: attackers spam push notifications hoping users approve accidentally.</li>
              <li>Number matching and additional context (location, app) are now defaults in Entra ID.</li>
              <li>Passwordless authentication (FIDO2, Windows Hello) eliminates password-based attacks entirely.</li>
              <li>Sign-in risk policies can block when unusual behavior is detected.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Conditional Access</tag>
        <tag>MFA Fatigue</tag>
        <tag>Attack Prevention</tag>
      </tags>
    </question>

    <question id="2" category-ref="cat-identity" difficulty="advanced">
      <title>Privileged Identity Management</title>
      <scenario>Your security team identified that 50 users have permanent Global Administrator access. You need to reduce standing privileges while ensuring admins can still perform their duties when needed.</scenario>
      <question-text>How should you implement just-in-time access for privileged roles?</question-text>
      <choices>
        <choice letter="A">Azure AD PIM with eligible assignments, approval workflows, and activation alerts</choice>
        <choice letter="B">Remove all admin access and grant on request via ticket</choice>
        <choice letter="C">Create separate admin accounts with permanent access</choice>
        <choice letter="D">Use shared admin accounts with MFA</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>PIM provides just-in-time privileged access with time-limited activation and audit trails.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Azure AD Privileged Identity Management (PIM) converts permanent assignments to eligible assignments. Users activate roles when needed, optionally requiring approval, MFA, and justification. Activations are time-limited (e.g., 8 hours) and fully audited. This dramatically reduces attack surface.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>PIM covers both Entra ID roles and Azure RBAC roles.</li>
              <li>Configure maximum activation duration (1-24 hours typically).</li>
              <li>Access reviews ensure ongoing role necessity.</li>
              <li>Alert on suspicious activation patterns (after hours, unusual frequency).</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>PIM</tag>
        <tag>Just-in-Time</tag>
        <tag>Privileged Access</tag>
      </tags>
    </question>

    <question id="3" category-ref="cat-identity" difficulty="advanced">
      <title>Identity Protection Policies</title>
      <scenario>You need to automatically respond to risky sign-ins and users with compromised credentials detected by Microsoft threat intelligence.</scenario>
      <question-text>Which Identity Protection policies should you configure?</question-text>
      <choices>
        <choice letter="A">Sign-in risk policy requiring MFA for medium/high risk, user risk policy requiring password change</choice>
        <choice letter="B">Block all sign-ins from outside the country</choice>
        <choice letter="C">Require MFA for all sign-ins without risk assessment</choice>
        <choice letter="D">Manual review of all sign-ins</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Identity Protection policies automate responses to detected sign-in and user risks.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Configure sign-in risk policy to require MFA (or block) for medium and high-risk sign-ins. Configure user risk policy to require password change for high-risk users (leaked credentials detected). This automates response to threats detected by Microsoft's machine learning and threat intelligence.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Sign-in risks: anonymous IP, atypical travel, malware-linked IP, unfamiliar location.</li>
              <li>User risks: leaked credentials, anomalous user activity.</li>
              <li>Risk levels: low, medium, high; configure thresholds appropriately.</li>
              <li>Self-remediation (password change) reduces admin burden.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Identity Protection</tag>
        <tag>Risk Policies</tag>
        <tag>Automated Response</tag>
      </tags>
    </question>

    <question id="4" category-ref="cat-identity" difficulty="intermediate">
      <title>Service Principal Security</title>
      <scenario>Applications in your environment use service principals to access Azure resources. You need to secure these identities and detect compromised credentials.</scenario>
      <question-text>What security measures should you implement for service principals?</question-text>
      <choices>
        <choice letter="A">Use managed identities where possible, certificate credentials for others, and workload identity federation for CI/CD</choice>
        <choice letter="B">Client secrets with no expiration for stability</choice>
        <choice letter="C">Shared service principal across all applications</choice>
        <choice letter="D">Store credentials in application configuration files</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Managed identities eliminate credentials; certificates are more secure than secrets; federation avoids stored credentials.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Prefer managed identities (system or user-assigned) which eliminate credential management entirely. For scenarios requiring service principals, use certificates over client secrets (harder to exfiltrate). For CI/CD, use workload identity federation to eliminate stored credentials. Monitor with Identity Protection for workload identities.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Managed identities: Azure manages credentials; auto-rotation; no exposure risk.</li>
              <li>Certificate credentials: 1-2 year validity; rotation required; store in Key Vault.</li>
              <li>Workload identity federation: OIDC tokens from GitHub/Azure DevOps exchanged for Azure tokens.</li>
              <li>Monitor service principal sign-ins in Entra ID sign-in logs.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Service Principals</tag>
        <tag>Managed Identity</tag>
        <tag>Workload Identity</tag>
      </tags>
    </question>

    <question id="5" category-ref="cat-identity" difficulty="advanced">
      <title>Emergency Access Accounts</title>
      <scenario>You need to ensure access to Azure AD if Conditional Access is misconfigured or federated identity provider fails, while maintaining security of these emergency accounts.</scenario>
      <question-text>How should you configure emergency access (break-glass) accounts?</question-text>
      <choices>
        <choice letter="A">Cloud-only accounts, excluded from CA policies, FIDO2 keys, heavily monitored with alerts</choice>
        <choice letter="B">Federated accounts with the same IDP as regular users</choice>
        <choice letter="C">Regular admin accounts with documented passwords</choice>
        <choice letter="D">Single account shared among all administrators</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Break-glass accounts must be cloud-only, excluded from CA, use hardware keys, and be heavily monitored.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Create at least two cloud-only emergency access accounts (not federated). Exclude from all Conditional Access policies. Use FIDO2 security keys (phishing-resistant, no MFA fatigue). Store credentials securely (safe, separate locations). Monitor all sign-ins with immediate alerts. Test quarterly.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Cloud-only ensures access even if federation fails.</li>
              <li>Different authentication methods per account (one FIDO2, one long password).</li>
              <li>Global Administrator role permanently assigned (not eligible in PIM).</li>
              <li>Alert on ANY sign-in; these accounts should rarely be used.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Break-Glass</tag>
        <tag>Emergency Access</tag>
        <tag>Business Continuity</tag>
      </tags>
    </question>

    <question id="6" category-ref="cat-network" difficulty="advanced">
      <title>Azure Firewall Configuration</title>
      <scenario>Your hub-spoke network requires centralized traffic inspection. You need to allow specific FQDNs for application updates, block known malicious IPs, and log all traffic.</scenario>
      <question-text>Which Azure Firewall features should you configure?</question-text>
      <choices>
        <choice letter="A">Application rules for FQDNs, threat intelligence filtering, and diagnostic logging to Log Analytics</choice>
        <choice letter="B">Network rules only based on IP addresses</choice>
        <choice letter="C">NAT rules for all outbound traffic</choice>
        <choice letter="D">Allow all traffic and rely on NSGs</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Application rules filter by FQDN; threat intelligence blocks known malicious IPs; diagnostics enable analysis.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Azure Firewall application rules allow filtering by FQDN (e.g., *.microsoft.com) instead of IPs. Enable threat intelligence-based filtering to automatically block traffic to/from known malicious IPs. Configure diagnostic settings to send all logs to Log Analytics for security analysis and compliance.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Rule priority: NAT rules, Network rules, Application rules (in processing order).</li>
              <li>FQDN tags: predefined groups like WindowsUpdate, AzureBackup.</li>
              <li>Premium tier adds TLS inspection, IDPS, and URL filtering.</li>
              <li>Forced tunneling requires management subnet for firewall health.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Azure Firewall</tag>
        <tag>FQDN Filtering</tag>
        <tag>Threat Intelligence</tag>
      </tags>
    </question>

    <question id="7" category-ref="cat-network" difficulty="advanced">
      <title>DDoS Protection</title>
      <scenario>Your public-facing web application has been targeted by volumetric DDoS attacks. You need protection with attack analytics and cost protection during attacks.</scenario>
      <question-text>Which DDoS protection tier should you implement?</question-text>
      <choices>
        <choice letter="A">DDoS Network Protection with diagnostic logging and cost protection</choice>
        <choice letter="B">DDoS Infrastructure Protection (Basic) only</choice>
        <choice letter="C">Azure Firewall without DDoS protection</choice>
        <choice letter="D">WAF without network-level DDoS protection</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>DDoS Network Protection provides enhanced protection, analytics, and cost protection guarantee.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>DDoS Network Protection (formerly Standard) provides adaptive tuning based on your traffic patterns, real-time attack metrics and alerts, detailed attack analytics, and cost protection (credits for scale-out costs during attacks). Basic protection is automatic but lacks these advanced features.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Network Protection: per-VNet protection plan; ~$2,944/month base.</li>
              <li>IP Protection: per-public-IP; cheaper for small deployments.</li>
              <li>DDoS Rapid Response (DRR) team available during active attacks.</li>
              <li>Combine with WAF for Layer 7 protection; DDoS handles Layer 3/4.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>DDoS Protection</tag>
        <tag>Attack Mitigation</tag>
        <tag>Network Security</tag>
      </tags>
    </question>

    <question id="8" category-ref="cat-network" difficulty="advanced">
      <title>Web Application Firewall</title>
      <scenario>Your web applications need protection against OWASP Top 10 vulnerabilities, bot attacks, and custom threat patterns specific to your applications.</scenario>
      <question-text>How should you configure WAF for comprehensive protection?</question-text>
      <choices>
        <choice letter="A">WAF policy with OWASP managed rules, bot protection, and custom rules in prevention mode</choice>
        <choice letter="B">WAF in detection mode permanently</choice>
        <choice letter="C">Custom rules only without managed rules</choice>
        <choice letter="D">Allow all traffic and log for analysis</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>WAF managed rules cover OWASP; bot protection blocks malicious bots; custom rules address app-specific threats.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Enable OWASP managed rule sets (DRS 2.1 recommended) for comprehensive coverage of common vulnerabilities. Enable bot protection to block known malicious bots while allowing legitimate ones. Add custom rules for application-specific patterns. Run in prevention mode to actively block attacks.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Start in detection mode to tune false positives before prevention.</li>
              <li>Exclusions allow bypassing rules for specific fields (e.g., file upload).</li>
              <li>Per-site policies enable different rules for different applications.</li>
              <li>WAF on Front Door provides global protection; App Gateway WAF is regional.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>WAF</tag>
        <tag>OWASP</tag>
        <tag>Bot Protection</tag>
      </tags>
    </question>

    <question id="9" category-ref="cat-network" difficulty="advanced">
      <title>Private Endpoint Security</title>
      <scenario>You're migrating PaaS services to use Private Endpoints. You need to ensure DNS resolution works correctly and that the public endpoints are disabled.</scenario>
      <question-text>What steps ensure secure Private Endpoint implementation?</question-text>
      <choices>
        <choice letter="A">Create Private DNS zones, link to VNets, disable public network access on services</choice>
        <choice letter="B">Use Private Endpoints with public DNS resolution</choice>
        <choice letter="C">Keep public endpoints enabled as fallback</choice>
        <choice letter="D">Use Service Endpoints instead for simplicity</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Private DNS zones resolve service FQDNs to private IPs; disable public access to ensure private-only communication.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Create Azure Private DNS zones for each service type (e.g., privatelink.blob.core.windows.net). Link zones to VNets needing resolution. The Private Endpoint automatically registers in the zone. Disable public network access on the PaaS service to ensure all traffic uses the private path.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Centralize Private DNS zones in hub; link to all spoke VNets.</li>
              <li>On-premises resolution requires DNS forwarder or Azure DNS Private Resolver.</li>
              <li>NSG on Private Endpoint subnet controls access (requires enabling).</li>
              <li>Disable public access: Storage firewall, SQL firewall, Key Vault firewall.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Private Endpoints</tag>
        <tag>Private DNS</tag>
        <tag>Zero Trust</tag>
      </tags>
    </question>

    <question id="10" category-ref="cat-network" difficulty="intermediate">
      <title>Network Security Groups</title>
      <scenario>You need to allow web traffic to a subnet while blocking all other inbound traffic. Administrative access should only be allowed from a specific management subnet.</scenario>
      <question-text>How should you configure NSG rules?</question-text>
      <choices>
        <choice letter="A">Allow HTTP/HTTPS from Internet, allow RDP/SSH from management subnet, deny all other inbound</choice>
        <choice letter="B">Allow all inbound traffic for flexibility</choice>
        <choice letter="C">Block all traffic including required services</choice>
        <choice letter="D">Use only the default NSG rules</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Create explicit allow rules for required traffic; implicit deny blocks everything else.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>NSG rules are processed by priority (lower number = higher priority). Create allow rules for web ports (80, 443) from Internet. Create allow rules for management ports (3389, 22) from the management subnet only. The implicit DenyAllInbound rule at priority 65500 blocks all other traffic.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Application Security Groups (ASGs) simplify rules by grouping VMs logically.</li>
              <li>NSG flow logs capture traffic decisions for analysis and compliance.</li>
              <li>Associate NSGs with subnets (preferred) or individual NICs.</li>
              <li>Augmented rules allow multiple ports/IPs in single rule (up to 4000 rules).</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>NSG</tag>
        <tag>Network Security</tag>
        <tag>Traffic Filtering</tag>
      </tags>
    </question>

    <question id="11" category-ref="cat-network" difficulty="advanced">
      <title>Just-in-Time VM Access</title>
      <scenario>Your security team requires that management ports on VMs are closed by default and only opened temporarily when administrators need access.</scenario>
      <question-text>How should you implement this requirement?</question-text>
      <choices>
        <choice letter="A">Enable JIT VM access in Microsoft Defender for Cloud</choice>
        <choice letter="B">Manually modify NSG rules when access is needed</choice>
        <choice letter="C">Keep management ports open with strong passwords</choice>
        <choice letter="D">Use VPN for all management access</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>JIT VM access automatically manages NSG rules to open ports only when requested and approved.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Just-in-Time (JIT) VM access in Defender for Cloud blocks management ports by default via NSG rules. Administrators request access for a specific time window and source IP. Upon approval, JIT temporarily opens the port. Access automatically revokes when the time expires.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>JIT creates deny rules at priority 100; approval adds allow rules at priority 99.</li>
              <li>Configure maximum request duration (e.g., 3 hours).</li>
              <li>Requires Defender for Servers Plan 2 or Defender for Cloud (paid tier).</li>
              <li>Combine with Azure Bastion for management without public IPs.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>JIT Access</tag>
        <tag>Defender for Cloud</tag>
        <tag>VM Security</tag>
      </tags>
    </question>

    <question id="12" category-ref="cat-compute" difficulty="advanced">
      <title>Defender for Servers</title>
      <scenario>Your organization needs to protect VMs against malware, detect vulnerabilities, and monitor for suspicious activities indicating compromise.</scenario>
      <question-text>Which Defender for Servers capabilities address these requirements?</question-text>
      <choices>
        <choice letter="A">Microsoft Defender for Endpoint integration, vulnerability assessment, and adaptive application controls</choice>
        <choice letter="B">Antivirus only without cloud protection</choice>
        <choice letter="C">Network-level protection only</choice>
        <choice letter="D">Manual vulnerability scanning</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Defender for Servers provides EDR, vulnerability scanning, and application whitelisting.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Defender for Servers includes Microsoft Defender for Endpoint (MDE) for real-time protection and EDR capabilities. Vulnerability assessment scans VMs for known CVEs. Adaptive application controls learn normal applications and alert/block unauthorized executables.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Plan 1: MDE integration only; Plan 2: adds vulnerability assessment, JIT, adaptive controls.</li>
              <li>Qualys scanner included at no extra cost; Microsoft MDVM is alternative.</li>
              <li>File integrity monitoring detects changes to sensitive files.</li>
              <li>Agentless scanning available for supported VMs without agent installation.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Defender for Servers</tag>
        <tag>EDR</tag>
        <tag>Vulnerability Management</tag>
      </tags>
    </question>

    <question id="13" category-ref="cat-compute" difficulty="advanced">
      <title>Container Security</title>
      <scenario>Your AKS clusters need protection against vulnerable images, runtime threats, and Kubernetes misconfigurations.</scenario>
      <question-text>Which Defender for Containers capabilities should you enable?</question-text>
      <choices>
        <choice letter="A">Image vulnerability scanning, runtime protection, and Kubernetes security posture</choice>
        <choice letter="B">Image scanning only without runtime protection</choice>
        <choice letter="C">Network policies only</choice>
        <choice letter="D">Manual container inspection</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Defender for Containers provides registry scanning, runtime protection, and configuration assessment.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Defender for Containers scans images in Azure Container Registry for vulnerabilities. Runtime protection detects suspicious activities in running containers (cryptomining, reverse shells). Kubernetes security posture identifies misconfigurations against benchmarks (CIS, Azure baseline).</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Defender sensor (DaemonSet) collects runtime security data from nodes.</li>
              <li>Azure Policy for Kubernetes enforces admission control (block vulnerable images).</li>
              <li>Agentless scanning available for registries without Defender sensor.</li>
              <li>CI/CD scanning with Defender extension for Azure DevOps/GitHub.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Defender for Containers</tag>
        <tag>Container Security</tag>
        <tag>AKS</tag>
      </tags>
    </question>

    <question id="14" category-ref="cat-compute" difficulty="intermediate">
      <title>App Service Security</title>
      <scenario>Your App Service hosts a customer-facing web application. You need to enforce HTTPS, restrict access to specific networks, and implement authentication.</scenario>
      <question-text>Which security configurations should you apply?</question-text>
      <choices>
        <choice letter="A">HTTPS Only, VNet integration with access restrictions, Easy Auth with Entra ID</choice>
        <choice letter="B">HTTP allowed for backward compatibility</choice>
        <choice letter="C">Public access from all networks</choice>
        <choice letter="D">Anonymous access for all users</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>HTTPS Only enforces encryption; access restrictions limit traffic sources; Easy Auth provides authentication.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Enable HTTPS Only to redirect all HTTP to HTTPS. Configure access restrictions to allow only specific IPs, VNets, or Service Endpoints. Use Easy Auth (Authentication/Authorization) to require Entra ID authentication without code changes. Enable managed identity for backend service access.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>TLS 1.2 minimum should be enforced; disable older versions.</li>
              <li>Private Endpoints enable fully private App Service access.</li>
              <li>Service Connector simplifies connecting to databases with managed identity.</li>
              <li>App Service Environment (ASE) provides isolated, dedicated infrastructure.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>App Service Security</tag>
        <tag>HTTPS</tag>
        <tag>Authentication</tag>
      </tags>
    </question>

    <question id="15" category-ref="cat-compute" difficulty="advanced">
      <title>Azure Kubernetes Service Security</title>
      <scenario>Your AKS cluster needs to be hardened: API server should be private, pods should use managed identity for Azure access, and network policies should restrict pod-to-pod traffic.</scenario>
      <question-text>Which AKS security features should you configure?</question-text>
      <choices>
        <choice letter="A">Private cluster, Azure AD workload identity, and Calico/Azure network policies</choice>
        <choice letter="B">Public API server with IP restrictions only</choice>
        <choice letter="C">Service principal credentials in pods</choice>
        <choice letter="D">No network policies for simplicity</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Private cluster removes public API; workload identity provides pod identity; network policies segment traffic.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Enable private cluster to make the API server accessible only via private endpoint. Use Azure AD workload identity (replacing pod identity) for pods to authenticate to Azure services without credentials. Enable network policy (Azure or Calico) to control pod-to-pod and pod-to-external traffic.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Private cluster requires Private DNS zone for API server resolution.</li>
              <li>Workload identity uses federated tokens; no secrets stored in cluster.</li>
              <li>Azure CNI vs Kubenet: CNI gives pods VNet IPs for direct network policy.</li>
              <li>Defender profile integrates Defender for Containers protection.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>AKS Security</tag>
        <tag>Private Cluster</tag>
        <tag>Network Policy</tag>
      </tags>
    </question>

    <question id="16" category-ref="cat-data" difficulty="advanced">
      <title>Storage Account Security</title>
      <scenario>Your storage accounts contain sensitive data. You need encryption with customer-managed keys, access only from your VNet, and immutable storage for compliance.</scenario>
      <question-text>Which storage security features should you configure?</question-text>
      <choices>
        <choice letter="A">CMK encryption, Private Endpoints with disabled public access, immutable blob storage with legal hold</choice>
        <choice letter="B">Microsoft-managed keys only</choice>
        <choice letter="C">Public access with SAS tokens</choice>
        <choice letter="D">Service Endpoints with public access enabled</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>CMK provides key control; Private Endpoints ensure private access; immutability prevents tampering.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Enable customer-managed keys (CMK) in Key Vault for encryption key control. Use Private Endpoints for private network access and disable public network access entirely. Enable immutable blob storage with legal hold for data that cannot be modified or deleted during retention period.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Infrastructure encryption (double encryption) adds a second encryption layer.</li>
              <li>Soft delete and versioning protect against accidental deletion.</li>
              <li>Legal hold: indefinite immutability; time-based retention: configurable period.</li>
              <li>Azure Policy can enforce these configurations across all storage accounts.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Storage Security</tag>
        <tag>CMK</tag>
        <tag>Immutable Storage</tag>
      </tags>
    </question>

    <question id="17" category-ref="cat-data" difficulty="advanced">
      <title>Azure SQL Security</title>
      <scenario>Your Azure SQL Database contains PII. You need data encryption, row-level access control, sensitive data discovery, and threat detection.</scenario>
      <question-text>Which SQL security features should you implement?</question-text>
      <choices>
        <choice letter="A">TDE with CMK, row-level security, data discovery and classification, Advanced Threat Protection</choice>
        <choice letter="B">TDE with Microsoft-managed keys only</choice>
        <choice letter="C">Application-level encryption only</choice>
        <choice letter="D">No encryption for performance</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>TDE encrypts data at rest; RLS controls row access; classification discovers PII; ATP detects threats.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Transparent Data Encryption (TDE) with customer-managed keys encrypts data at rest. Row-level security (RLS) filters rows based on user context. Data discovery and classification identifies and labels sensitive columns. Advanced Threat Protection detects SQL injection, anomalous access, and data exfiltration.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Always Encrypted: client-side encryption; data never decrypted on server.</li>
              <li>Dynamic data masking: masks data for non-privileged users.</li>
              <li>Ledger: append-only, cryptographically verifiable tables.</li>
              <li>Microsoft Purview extends classification to full data estate.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>SQL Security</tag>
        <tag>Data Protection</tag>
        <tag>Threat Detection</tag>
      </tags>
    </question>

    <question id="18" category-ref="cat-data" difficulty="advanced">
      <title>Key Vault Security</title>
      <scenario>Your Key Vault stores cryptographic keys and secrets for production applications. You need to protect against accidental deletion, control access granularly, and audit all operations.</scenario>
      <question-text>Which Key Vault security features should you configure?</question-text>
      <choices>
        <choice letter="A">Soft-delete with purge protection, RBAC access control, diagnostic logging to Log Analytics</choice>
        <choice letter="B">Access policies with broad permissions</choice>
        <choice letter="C">Allow public network access</choice>
        <choice letter="D">No deletion protection for flexibility</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Soft-delete prevents permanent loss; purge protection prevents early purge; RBAC enables granular access; logging enables audit.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Enable soft-delete (retains deleted items for 90 days) and purge protection (prevents purging during retention). Use RBAC for granular access control (e.g., Key Vault Secrets User for reading secrets only). Configure diagnostic settings to send audit logs to Log Analytics for security monitoring.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Soft-delete enabled by default; purge protection must be explicitly enabled.</li>
              <li>RBAC vs access policies: RBAC is recommended; supports individual secret permissions.</li>
              <li>Private Endpoints eliminate public network exposure.</li>
              <li>HSM-backed keys provide FIPS 140-2 Level 3 protection.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Key Vault</tag>
        <tag>Secrets Management</tag>
        <tag>Access Control</tag>
      </tags>
    </question>

    <question id="19" category-ref="cat-data" difficulty="intermediate">
      <title>Data Loss Prevention</title>
      <scenario>You need to prevent sensitive data (credit card numbers, SSNs) from being stored in unauthorized locations or shared externally.</scenario>
      <question-text>Which solution provides data loss prevention capabilities?</question-text>
      <choices>
        <choice letter="A">Microsoft Purview Data Loss Prevention policies</choice>
        <choice letter="B">Azure Firewall application rules</choice>
        <choice letter="C">Storage account firewall only</choice>
        <choice letter="D">Manual data review</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Microsoft Purview DLP detects sensitive data and enforces policies to prevent unauthorized sharing.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Microsoft Purview Data Loss Prevention (DLP) policies identify sensitive information types (credit cards, SSNs, custom patterns) and enforce actions: block sharing, require justification, notify admins. DLP covers Exchange, SharePoint, OneDrive, Teams, and endpoint devices.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Sensitive information types: 300+ built-in; custom types for organization-specific data.</li>
              <li>DLP policies can apply to specific users, groups, or locations.</li>
              <li>Endpoint DLP extends protection to Windows/macOS devices.</li>
              <li>Sensitivity labels integrate with DLP for classification-based policies.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>DLP</tag>
        <tag>Data Protection</tag>
        <tag>Microsoft Purview</tag>
      </tags>
    </question>

    <question id="20" category-ref="cat-data" difficulty="advanced">
      <title>Cosmos DB Security</title>
      <scenario>Your globally distributed Cosmos DB contains customer data. You need network isolation, encryption with customer-managed keys, and fine-grained access control.</scenario>
      <question-text>How should you secure the Cosmos DB account?</question-text>
      <choices>
        <choice letter="A">Private Endpoints, CMK encryption, Azure AD RBAC for data plane operations</choice>
        <choice letter="B">IP firewall with public access</choice>
        <choice letter="C">Primary key shared across all applications</choice>
        <choice letter="D">Service Endpoints without CMK</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Private Endpoints isolate network; CMK controls encryption keys; Azure AD RBAC enables identity-based access.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Use Private Endpoints to eliminate public network exposure. Enable customer-managed keys for encryption control. Configure Azure AD RBAC for data plane access, allowing identity-based permissions instead of sharing primary keys. This eliminates credential management while enabling fine-grained access.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Data plane RBAC roles: Cosmos DB Data Reader, Data Contributor, etc.</li>
              <li>Disable key-based authentication after migrating to RBAC.</li>
              <li>Always Encrypted: client-side encryption for highly sensitive fields.</li>
              <li>Disable local auth: disallows primary/secondary key authentication.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Cosmos DB Security</tag>
        <tag>Azure AD RBAC</tag>
        <tag>Data Plane Security</tag>
      </tags>
    </question>

    <question id="21" category-ref="cat-operations" difficulty="advanced">
      <title>Microsoft Sentinel Deployment</title>
      <scenario>You need to implement a cloud-native SIEM for threat detection, investigation, and automated response across your Azure environment and on-premises systems.</scenario>
      <question-text>How should you deploy Microsoft Sentinel?</question-text>
      <choices>
        <choice letter="A">Sentinel workspace with data connectors, analytics rules, and playbooks for automation</choice>
        <choice letter="B">Log Analytics workspace without Sentinel features</choice>
        <choice letter="C">Third-party SIEM only</choice>
        <choice letter="D">Manual log review</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Sentinel provides SIEM/SOAR on Log Analytics; data connectors ingest logs; analytics detect threats; playbooks respond.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Enable Microsoft Sentinel on a Log Analytics workspace. Configure data connectors to ingest logs from Azure services, Microsoft 365, on-premises, and third-party sources. Enable analytics rules to detect threats. Create playbooks (Logic Apps) for automated investigation and response.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Content hub provides packaged solutions with connectors, rules, and workbooks.</li>
              <li>UEBA (User and Entity Behavior Analytics) detects anomalous behavior.</li>
              <li>Fusion uses ML to correlate low-fidelity alerts into high-confidence incidents.</li>
              <li>Cost: pay per GB ingested; commitment tiers provide discounts.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Microsoft Sentinel</tag>
        <tag>SIEM</tag>
        <tag>Threat Detection</tag>
      </tags>
    </question>

    <question id="22" category-ref="cat-operations" difficulty="advanced">
      <title>Security Alerts and Incidents</title>
      <scenario>Your SOC receives hundreds of security alerts daily. You need to prioritize critical threats, reduce alert fatigue, and streamline incident investigation.</scenario>
      <question-text>How should you manage security alerts in Defender for Cloud and Sentinel?</question-text>
      <choices>
        <choice letter="A">Alert suppression rules for known benign, incident correlation, and automated triage playbooks</choice>
        <choice letter="B">Investigate every alert manually</choice>
        <choice letter="C">Disable alerting to reduce noise</choice>
        <choice letter="D">Forward all alerts to email</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Suppress known false positives; correlate related alerts into incidents; automate initial triage.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Create suppression rules for alerts that are known benign (e.g., authorized security scanning). Sentinel automatically correlates related alerts into incidents for unified investigation. Build playbooks to automate initial triage: enrich alerts with threat intelligence, run queries, and escalate critical incidents.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Alert severity: High, Medium, Low, Informational; prioritize by severity.</li>
              <li>MITRE ATT&CK mapping helps understand attack tactics and techniques.</li>
              <li>Automation rules trigger playbooks automatically on incident creation.</li>
              <li>Watchlists enrich alerts with organizational context (VIP users, critical assets).</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Alert Management</tag>
        <tag>Incident Response</tag>
        <tag>SOC Operations</tag>
      </tags>
    </question>

    <question id="23" category-ref="cat-operations" difficulty="advanced">
      <title>Threat Hunting</title>
      <scenario>Your security team needs to proactively search for threats that may have evaded automated detection, using hypothesis-driven queries.</scenario>
      <question-text>How should you enable threat hunting in your environment?</question-text>
      <choices>
        <choice letter="A">Sentinel hunting queries with KQL, bookmarks, and livestream for real-time hunting</choice>
        <choice letter="B">Wait for alerts to indicate threats</choice>
        <choice letter="C">Periodic manual log review</choice>
        <choice letter="D">External threat intelligence feeds only</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Sentinel hunting uses KQL queries to proactively search for threats; bookmarks save findings; livestream monitors in real-time.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Microsoft Sentinel provides built-in and custom hunting queries using KQL. Hunters develop hypotheses and query logs for indicators. Bookmarks save interesting results for investigation. Livestream allows real-time query execution during active incidents. Promote successful hunts to analytics rules.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Hunting queries can be scheduled as analytics rules after validation.</li>
              <li>Notebooks (Jupyter) enable advanced analysis with Python libraries.</li>
              <li>MITRE ATT&CK coverage shows gaps in detection for specific techniques.</li>
              <li>TI (Threat Intelligence) integration enriches hunting with IOCs.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Threat Hunting</tag>
        <tag>KQL</tag>
        <tag>Proactive Security</tag>
      </tags>
    </question>

    <question id="24" category-ref="cat-operations" difficulty="intermediate">
      <title>Secure Score</title>
      <scenario>Management wants visibility into your organization's security posture and a prioritized list of actions to improve security.</scenario>
      <question-text>Which feature provides security posture assessment with recommendations?</question-text>
      <choices>
        <choice letter="A">Microsoft Defender for Cloud Secure Score</choice>
        <choice letter="B">Azure Advisor cost recommendations</choice>
        <choice letter="C">Azure Monitor metrics</choice>
        <choice letter="D">Activity Log</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Secure Score measures security posture and provides prioritized recommendations to improve.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Defender for Cloud Secure Score aggregates security findings into a percentage score. Recommendations are prioritized by potential impact on the score. Each recommendation includes remediation steps and often a Quick Fix option. Track score over time to demonstrate security improvement.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Secure Score covers multiple security domains: identity, data, compute, network.</li>
              <li>Exemptions allow accepting risk for specific recommendations.</li>
              <li>Regulatory compliance shows adherence to standards (CIS, NIST, PCI-DSS).</li>
              <li>Score impacts from recommendations help prioritize high-value fixes.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Secure Score</tag>
        <tag>Security Posture</tag>
        <tag>Defender for Cloud</tag>
      </tags>
    </question>

    <question id="25" category-ref="cat-operations" difficulty="advanced">
      <title>Compliance Management</title>
      <scenario>Your organization must demonstrate compliance with HIPAA, PCI-DSS, and SOC 2. You need continuous compliance monitoring and evidence collection.</scenario>
      <question-text>How should you manage compliance in Azure?</question-text>
      <choices>
        <choice letter="A">Defender for Cloud regulatory compliance dashboard with Azure Policy initiatives</choice>
        <choice letter="B">Manual compliance assessments annually</choice>
        <choice letter="C">Third-party audit tools only</choice>
        <choice letter="D">Compliance documentation without automated assessment</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Defender for Cloud maps security controls to regulatory standards; Azure Policy enforces and reports compliance.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Defender for Cloud regulatory compliance dashboard shows continuous compliance status against standards (HIPAA, PCI-DSS, SOC 2, NIST). Azure Policy initiatives define required controls and report non-compliance. Export compliance reports for auditors. Microsoft Purview Compliance Manager provides additional compliance tools.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Add additional regulatory standards from the compliance dashboard.</li>
              <li>Custom compliance standards can be created using Azure Policy.</li>
              <li>Continuous export sends compliance data to Log Analytics or Event Hub.</li>
              <li>Service Trust Portal provides Microsoft audit reports and compliance documentation.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Compliance</tag>
        <tag>Regulatory Standards</tag>
        <tag>Audit</tag>
      </tags>
    </question>

    <question id="26" category-ref="cat-identity" difficulty="advanced">
      <title>Cross-Tenant Access</title>
      <scenario>Your organization collaborates with partner companies. You need to control which external organizations can access your resources and what access your users have to external organizations.</scenario>
      <question-text>How should you configure cross-tenant access?</question-text>
      <choices>
        <choice letter="A">Cross-tenant access settings with inbound and outbound policies per organization</choice>
        <choice letter="B">Allow all B2B collaboration without restrictions</choice>
        <choice letter="C">Block all external collaboration</choice>
        <choice letter="D">Share credentials with partner organizations</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Cross-tenant access settings control B2B collaboration policies per external organization.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Entra ID cross-tenant access settings define inbound policies (what external users can do in your tenant) and outbound policies (what your users can do in external tenants). Configure default settings for all organizations and override for specific trusted partners with more permissive access.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>B2B collaboration: guest users in your tenant.</li>
              <li>B2B direct connect: shared channels without guest accounts (Teams).</li>
              <li>Trust settings: trust partner MFA and device claims to reduce friction.</li>
              <li>Organizational relationships: specify tenant IDs for trusted partners.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Cross-Tenant</tag>
        <tag>B2B Collaboration</tag>
        <tag>External Access</tag>
      </tags>
    </question>

    <question id="27" category-ref="cat-identity" difficulty="intermediate">
      <title>Azure RBAC Best Practices</title>
      <scenario>Your organization is assigning Azure permissions. You need to follow the principle of least privilege while maintaining operational efficiency.</scenario>
      <question-text>Which RBAC practices should you implement?</question-text>
      <choices>
        <choice letter="A">Use built-in roles at narrowest scope, assign to groups, use PIM for privileged roles</choice>
        <choice letter="B">Assign Owner at subscription level for simplicity</choice>
        <choice letter="C">Create custom roles for every user</choice>
        <choice letter="D">Assign permissions to individual users</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Narrow scope reduces blast radius; group assignment simplifies management; PIM reduces standing access.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Assign roles at the narrowest appropriate scope (resource group > subscription > management group). Use built-in roles before creating custom ones. Assign to Entra ID groups for easier management. Use PIM for privileged roles to reduce standing access. Regular access reviews ensure ongoing appropriateness.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Scope hierarchy: permissions inherit from parent to child.</li>
              <li>Deny assignments exist but are rare; managed by Azure Blueprints.</li>
              <li>Classic roles (Service Administrator, Co-Administrator) are legacy; migrate to RBAC.</li>
              <li>Custom roles can be scoped to specific subscriptions or management groups.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>RBAC</tag>
        <tag>Least Privilege</tag>
        <tag>Access Management</tag>
      </tags>
    </question>

    <question id="28" category-ref="cat-network" difficulty="advanced">
      <title>Network Segmentation</title>
      <scenario>Your workloads have different security requirements: public-facing web tier, application tier, and sensitive data tier. You need to isolate these tiers.</scenario>
      <question-text>How should you design network segmentation?</question-text>
      <choices>
        <choice letter="A">Separate subnets with NSGs, Azure Firewall for inter-tier traffic, and Private Endpoints for data tier</choice>
        <choice letter="B">Single subnet for all tiers</choice>
        <choice letter="C">Separate VNets without connectivity</choice>
        <choice letter="D">NSGs only without additional controls</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Subnets with NSGs provide basic segmentation; firewall inspects inter-tier traffic; Private Endpoints protect data tier.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Create separate subnets for each tier with NSGs restricting traffic to required ports and sources. Route inter-tier traffic through Azure Firewall for inspection and logging. Use Private Endpoints for data tier access, eliminating public network exposure. This creates defense in depth.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Microsegmentation: NSGs and ASGs for fine-grained pod-to-pod rules.</li>
              <li>Azure Firewall Premium: TLS inspection for encrypted traffic visibility.</li>
              <li>Subnet delegation: some services require dedicated subnets.</li>
              <li>Service tags simplify NSG rules for Azure services.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Network Segmentation</tag>
        <tag>Defense in Depth</tag>
        <tag>Zero Trust</tag>
      </tags>
    </question>

    <question id="29" category-ref="cat-compute" difficulty="intermediate">
      <title>VM Disk Encryption</title>
      <scenario>Your VMs contain sensitive data. You need to encrypt OS and data disks with customer-managed keys and ensure encryption at the host level.</scenario>
      <question-text>Which encryption options should you configure?</question-text>
      <choices>
        <choice letter="A">Azure Disk Encryption or Encryption at Host with customer-managed keys in Key Vault</choice>
        <choice letter="B">Platform-managed keys only</choice>
        <choice letter="C">No encryption for performance</choice>
        <choice letter="D">Third-party encryption software only</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Azure Disk Encryption uses BitLocker/DM-Crypt; Encryption at Host encrypts at the hypervisor; both support CMK.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Azure Disk Encryption (ADE) uses BitLocker (Windows) or DM-Crypt (Linux) for OS and data disk encryption. Encryption at Host provides encryption before data leaves the VM, including temp disks and caches. Both support customer-managed keys stored in Key Vault for key control.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>ADE vs Encryption at Host: ADE is guest-level; EaH is platform-level.</li>
              <li>Server-side encryption (SSE) is always on for managed disks (at rest).</li>
              <li>Double encryption: SSE + ADE or SSE + EaH for compliance requirements.</li>
              <li>Confidential VMs: use AMD SEV-SNP for memory encryption.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Disk Encryption</tag>
        <tag>VM Security</tag>
        <tag>CMK</tag>
      </tags>
    </question>

    <question id="30" category-ref="cat-data" difficulty="advanced">
      <title>Azure Backup Security</title>
      <scenario>Ransomware attacks target backups to prevent recovery. You need to protect backup data from deletion or encryption by attackers.</scenario>
      <question-text>Which Azure Backup security features should you enable?</question-text>
      <choices>
        <choice letter="A">Soft delete, immutable vaults, multi-user authorization, and enhanced security</choice>
        <choice letter="B">Standard backups without additional protection</choice>
        <choice letter="C">Local backups on VMs only</choice>
        <choice letter="D">Backups without soft delete for immediate cleanup</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Soft delete retains deleted backups; immutable vaults prevent modification; MUA requires multiple approvals.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Enable soft delete to retain deleted backup data for 14 additional days. Configure immutable vaults to prevent deletion or early expiration of backups. Multi-user authorization (MUA) requires Resource Guard approval for critical operations. Enhanced security provides additional malware scanning and alerts.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Soft delete: 14-day retention; can be extended; cannot be disabled once enabled.</li>
              <li>Immutability: locked policies prevent even admins from deleting backups.</li>
              <li>Resource Guard: separate resource in different subscription for MUA.</li>
              <li>Private Endpoints for backup traffic; restrict access to Recovery Services vault.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Backup Security</tag>
        <tag>Ransomware Protection</tag>
        <tag>Immutable Vaults</tag>
      </tags>
    </question>

    <question id="31" category-ref="cat-operations" difficulty="advanced">
      <title>Security Automation</title>
      <scenario>Your security team wants to automate responses to common security incidents: isolating compromised VMs, blocking malicious IPs, and notifying stakeholders.</scenario>
      <question-text>How should you implement security automation?</question-text>
      <choices>
        <choice letter="A">Sentinel playbooks with Logic Apps for automated response actions</choice>
        <choice letter="B">Manual incident response procedures</choice>
        <choice letter="C">Email notifications only</choice>
        <choice letter="D">Disable automated responses for control</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Sentinel playbooks use Logic Apps to automate investigation and response actions.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Microsoft Sentinel playbooks are Logic Apps triggered by alerts or incidents. They can automatically isolate VMs (NSG changes), block IPs in firewall, enrich alerts with threat intelligence, create tickets in ServiceNow, and notify via Teams/email. Automation rules control when playbooks run.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Playbook triggers: alert trigger (per alert) or incident trigger (correlated).</li>
              <li>Built-in playbook templates for common scenarios (isolate VM, block IP).</li>
              <li>Managed identity or service principal for playbook to take actions.</li>
              <li>Test playbooks in non-production before enabling automated execution.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Security Automation</tag>
        <tag>SOAR</tag>
        <tag>Playbooks</tag>
      </tags>
    </question>

    <question id="32" category-ref="cat-identity" difficulty="advanced">
      <title>Passwordless Authentication</title>
      <scenario>Your organization wants to eliminate passwords to reduce phishing risk and improve user experience.</scenario>
      <question-text>Which passwordless authentication methods should you deploy?</question-text>
      <choices>
        <choice letter="A">Windows Hello for Business, FIDO2 security keys, and Microsoft Authenticator passwordless</choice>
        <choice letter="B">Complex passwords with MFA</choice>
        <choice letter="C">Single sign-on without strong authentication</choice>
        <choice letter="D">Certificate-based authentication only</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Passwordless methods are phishing-resistant and provide better security than passwords with MFA.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Deploy Windows Hello for Business for managed Windows devices (biometric or PIN backed by TPM). Offer FIDO2 security keys for shared devices or users preferring hardware tokens. Enable Microsoft Authenticator passwordless for mobile users. All three are phishing-resistant unlike password+SMS.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>FIDO2: open standard; works across platforms; no shared secrets.</li>
              <li>Windows Hello: device-bound credential; biometric or PIN; TPM protected.</li>
              <li>Certificate-based authentication (CBA): another phishing-resistant option.</li>
              <li>Authentication strength in Conditional Access can require phishing-resistant methods.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Passwordless</tag>
        <tag>FIDO2</tag>
        <tag>Windows Hello</tag>
      </tags>
    </question>

    <question id="33" category-ref="cat-network" difficulty="advanced">
      <title>Azure Bastion</title>
      <scenario>Administrators need secure access to VMs without exposing management ports to the internet or requiring VPN clients.</scenario>
      <question-text>How should you configure Azure Bastion for secure VM access?</question-text>
      <choices>
        <choice letter="A">Bastion Standard tier with native client support, shareable links disabled, and diagnostics enabled</choice>
        <choice letter="B">Public IPs on all VMs with NSG restrictions</choice>
        <choice letter="C">VPN for all administrative access</choice>
        <choice letter="D">Jump box VM with public IP</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Bastion provides browser-based RDP/SSH without public IPs; Standard tier adds native client and features.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Azure Bastion provides secure RDP/SSH through the Azure portal without public IPs on VMs. Standard tier enables native client (az network bastion tunnel), file upload/download, and host scaling. Disable shareable links in production for security. Enable diagnostic logs for audit.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Bastion requires dedicated subnet named AzureBastionSubnet (/26 minimum).</li>
              <li>Premium tier: session recording, private-only deployment.</li>
              <li>Can be shared across peered VNets to reduce cost.</li>
              <li>Combine with JIT access for additional protection on management ports.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Azure Bastion</tag>
        <tag>Secure Access</tag>
        <tag>Jump Host</tag>
      </tags>
    </question>

    <question id="34" category-ref="cat-compute" difficulty="advanced">
      <title>Confidential Computing</title>
      <scenario>Your application processes highly sensitive data. You need to protect data while in use, ensuring even Azure operators cannot access it.</scenario>
      <question-text>Which Azure service provides hardware-based data-in-use protection?</question-text>
      <choices>
        <choice letter="A">Azure Confidential VMs with AMD SEV-SNP or Intel TDX</choice>
        <choice letter="B">Standard VMs with disk encryption</choice>
        <choice letter="C">Container Instances with encryption</choice>
        <choice letter="D">Managed identities only</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Confidential VMs use hardware-based TEEs to encrypt data in memory, protecting from the host.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Azure Confidential VMs use AMD SEV-SNP or Intel TDX to create hardware-based Trusted Execution Environments (TEEs). Memory is encrypted with keys inaccessible to Azure. Remote attestation verifies the environment before releasing sensitive data. This protects data even from privileged administrators.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Full memory encryption: entire VM memory encrypted, not just enclaves.</li>
              <li>Attestation: cryptographic proof of TEE integrity before processing.</li>
              <li>Confidential containers: AKS confidential computing nodes.</li>
              <li>Always Encrypted with secure enclaves: SQL Server data processing in TEE.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Confidential Computing</tag>
        <tag>Data in Use</tag>
        <tag>TEE</tag>
      </tags>
    </question>

    <question id="35" category-ref="cat-data" difficulty="intermediate">
      <title>Microsoft Purview Data Governance</title>
      <scenario>Your organization needs visibility into sensitive data across Azure, on-premises, and multi-cloud environments for governance and compliance.</scenario>
      <question-text>Which solution provides unified data discovery and classification?</question-text>
      <choices>
        <choice letter="A">Microsoft Purview Data Map with automated scanning and sensitivity labels</choice>
        <choice letter="B">Manual data inventory in spreadsheets</choice>
        <choice letter="C">Azure Resource Graph for data discovery</choice>
        <choice letter="D">Storage account reports only</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Purview Data Map scans data sources, classifies sensitive data, and provides a unified data catalog.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Microsoft Purview Data Map scans data sources (Azure, AWS, on-premises) to discover and classify data automatically. It identifies sensitive information types (PII, PCI, PHI) and applies sensitivity labels. Data catalog provides lineage, glossary, and governance insights across the data estate.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Scans: Azure Blob, ADLS, SQL, Cosmos DB, Synapse, AWS S3, on-premises SQL.</li>
              <li>Classification rules: built-in for 200+ types; custom patterns supported.</li>
              <li>Data lineage: visualize data flow from source to destination.</li>
              <li>Integration with Defender for Cloud for security insights.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Microsoft Purview</tag>
        <tag>Data Governance</tag>
        <tag>Classification</tag>
      </tags>
    </question>

    <question id="36" category-ref="cat-operations" difficulty="advanced">
      <title>Log Analytics Security</title>
      <scenario>Your Log Analytics workspace contains sensitive security logs. You need to control who can query specific tables and protect log integrity.</scenario>
      <question-text>How should you secure the Log Analytics workspace?</question-text>
      <choices>
        <choice letter="A">Table-level RBAC, resource-context access, and customer-managed keys</choice>
        <choice letter="B">Workspace-level permissions for all users</choice>
        <choice letter="C">Public access to logs for transparency</choice>
        <choice letter="D">No access controls for operational efficiency</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Table-level RBAC restricts access to sensitive tables; resource-context limits queries to owned resources; CMK protects data.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Configure table-level RBAC to grant access to specific tables only (e.g., security team to SecurityEvent). Enable resource-context access mode so users only see logs from resources they have access to. Use customer-managed keys for encryption control. Enable data export for long-term retention in secure storage.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Access modes: workspace-context (see all data in workspace) vs resource-context (see data for accessible resources).</li>
              <li>Custom log tables can have different RBAC than built-in tables.</li>
              <li>Dedicated cluster: isolated compute, CMK, and commitment tier pricing.</li>
              <li>Search job: query archived data from long-term storage.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Log Analytics Security</tag>
        <tag>RBAC</tag>
        <tag>Data Protection</tag>
      </tags>
    </question>

    <question id="37" category-ref="cat-identity" difficulty="advanced">
      <title>Entitlement Management</title>
      <scenario>External contractors need time-limited access to Azure resources and applications. Access should be self-service with approval workflows and automatic expiration.</scenario>
      <question-text>How should you manage external user access lifecycle?</question-text>
      <choices>
        <choice letter="A">Entra ID Entitlement Management with access packages, approval workflows, and automatic expiration</choice>
        <choice letter="B">Manual guest user creation without expiration</choice>
        <choice letter="C">Shared accounts for contractors</choice>
        <choice letter="D">Full employee access for contractors</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Entitlement Management provides governed, self-service access with approval and lifecycle management.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Entra ID Entitlement Management creates access packages bundling group memberships, app access, and SharePoint sites. External users request access via portal; workflows route to approvers. Access automatically expires after configured period. Access reviews ensure ongoing necessity.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Connected organizations: configure for known partner companies.</li>
              <li>Multiple policies per package: different rules for internal vs external.</li>
              <li>Separation of duties: requestor cannot be sole approver.</li>
              <li>Lifecycle workflows: automate onboarding/offboarding tasks.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Entitlement Management</tag>
        <tag>Access Lifecycle</tag>
        <tag>External Users</tag>
      </tags>
    </question>

    <question id="38" category-ref="cat-network" difficulty="intermediate">
      <title>ExpressRoute Security</title>
      <scenario>Your ExpressRoute connection provides private connectivity to Azure. You need to ensure traffic is encrypted and that the connection meets security requirements.</scenario>
      <question-text>How should you secure ExpressRoute traffic?</question-text>
      <choices>
        <choice letter="A">Configure MACsec for ExpressRoute Direct or IPsec VPN over ExpressRoute</choice>
        <choice letter="B">ExpressRoute provides encryption by default</choice>
        <choice letter="C">No additional encryption needed for private connection</choice>
        <choice letter="D">SSL certificates for all traffic</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>ExpressRoute is private but not encrypted by default; MACsec or IPsec adds encryption.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>ExpressRoute provides private connectivity but doesn't encrypt traffic by default. For ExpressRoute Direct, enable MACsec for point-to-point encryption between your router and Microsoft's. Alternatively, create a VPN tunnel over ExpressRoute for IPsec encryption. This addresses compliance requirements for encryption.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>MACsec: Layer 2 encryption; requires ExpressRoute Direct (dedicated ports).</li>
              <li>IPsec over ExpressRoute: create VPN Gateway and connect via ExpressRoute path.</li>
              <li>Application-level TLS is always recommended regardless of network encryption.</li>
              <li>ExpressRoute Global Reach traffic between on-premises sites is not encrypted.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>ExpressRoute Security</tag>
        <tag>MACsec</tag>
        <tag>Encryption</tag>
      </tags>
    </question>

    <question id="39" category-ref="cat-compute" difficulty="intermediate">
      <title>Update Management</title>
      <scenario>Your VMs need regular security patches. You need to assess missing updates, schedule maintenance windows, and report compliance.</scenario>
      <question-text>How should you manage VM updates?</question-text>
      <choices>
        <choice letter="A">Azure Update Manager with assessment, scheduled deployments, and compliance reporting</choice>
        <choice letter="B">Manual patching during business hours</choice>
        <choice letter="C">Automatic updates without scheduling</choice>
        <choice letter="D">Defer all updates until annual maintenance</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Azure Update Manager provides assessment, scheduled deployments, and compliance reporting for VM patches.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Azure Update Manager assesses VMs for missing updates, schedules update deployments during maintenance windows, and reports compliance status. Configure pre/post scripts for graceful application handling. Supports Windows and Linux VMs in Azure, on-premises, and other clouds via Arc.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Update classifications: Critical, Security, Definition, Update Rollup, etc.</li>
              <li>Maintenance configurations define when updates can be applied.</li>
              <li>Azure Policy can audit or enforce update compliance.</li>
              <li>Hotpatch (preview) applies updates without reboot for supported Windows.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Update Management</tag>
        <tag>Patch Management</tag>
        <tag>Compliance</tag>
      </tags>
    </question>

    <question id="40" category-ref="cat-operations" difficulty="advanced">
      <title>Threat Intelligence</title>
      <scenario>Your security team needs to enrich alerts with threat intelligence and proactively hunt for known indicators of compromise (IOCs).</scenario>
      <question-text>How should you integrate threat intelligence?</question-text>
      <choices>
        <choice letter="A">Microsoft Sentinel Threat Intelligence with TI connectors and TI-based analytics rules</choice>
        <choice letter="B">Manual IOC lookup for each alert</choice>
        <choice letter="C">Rely on vendor threat feeds only</choice>
        <choice letter="D">No threat intelligence integration</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Sentinel TI integrates threat feeds and matches against logs for automatic detection.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Microsoft Sentinel Threat Intelligence imports indicators from Microsoft Defender TI, TAXII feeds, and custom sources. TI-based analytics rules automatically match indicators against logs to detect known threats. TI workbench helps analyze and manage indicators for hunting.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Indicator types: IP, domain, URL, file hash, email address.</li>
              <li>Microsoft Defender Threat Intelligence (MDTI) provides premium TI.</li>
              <li>STIX/TAXII: standard formats for threat intelligence sharing.</li>
              <li>TI matching rules: correlate indicators with network, DNS, and file logs.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Threat Intelligence</tag>
        <tag>IOC</tag>
        <tag>Detection</tag>
      </tags>
    </question>

    <question id="41" category-ref="cat-data" difficulty="advanced">
      <title>Sensitivity Labels</title>
      <scenario>Your organization needs to classify and protect documents based on sensitivity level. Protection should persist when documents are shared externally.</scenario>
      <question-text>How should you implement document classification and protection?</question-text>
      <choices>
        <choice letter="A">Microsoft Purview sensitivity labels with encryption and rights management</choice>
        <choice letter="B">Folder-based classification only</choice>
        <choice letter="C">Document naming conventions</choice>
        <choice letter="D">Manual access control per document</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Sensitivity labels apply classification and encryption that travels with documents.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Microsoft Purview sensitivity labels classify and protect documents and emails. Labels can apply encryption (Azure Rights Management), content markings (headers, watermarks), and access restrictions. Protection persists when documents are shared externally. Auto-labeling can apply labels based on content.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Label hierarchy: Public < General < Confidential < Highly Confidential.</li>
              <li>Encryption options: user-defined permissions or admin-defined protection.</li>
              <li>Auto-labeling: client-side recommendations or service-side automatic application.</li>
              <li>Double Key Encryption (DKE) for highest sensitivity with customer-held key.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Sensitivity Labels</tag>
        <tag>Information Protection</tag>
        <tag>Rights Management</tag>
      </tags>
    </question>

    <question id="42" category-ref="cat-identity" difficulty="intermediate">
      <title>Access Reviews</title>
      <scenario>You need to periodically verify that users still need their access to groups, applications, and Azure roles.</scenario>
      <question-text>How should you implement ongoing access validation?</question-text>
      <choices>
        <choice letter="A">Entra ID Access Reviews with regular schedules and automatic removal</choice>
        <choice letter="B">Annual manual access audit</choice>
        <choice letter="C">Never remove access once granted</choice>
        <choice letter="D">Manager verbal confirmation</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Access reviews automate periodic verification and can automatically remove unconfirmed access.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Entra ID Access Reviews create periodic reviews for group memberships, application access, and Azure roles. Reviewers (managers, self, or designated) confirm or deny access. Configure automatic actions: remove denied access, remove if not reviewed, or notify only. Supports PIM role assignments.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Review frequency: weekly, monthly, quarterly, annually.</li>
              <li>Multi-stage reviews: multiple reviewers in sequence.</li>
              <li>Decision helpers: show recommendations based on last sign-in.</li>
              <li>Access review history for compliance audit trails.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Access Reviews</tag>
        <tag>Identity Governance</tag>
        <tag>Compliance</tag>
      </tags>
    </question>

    <question id="43" category-ref="cat-network" difficulty="advanced">
      <title>Network Watcher Security</title>
      <scenario>You need to troubleshoot network connectivity issues, verify NSG rules are working correctly, and capture traffic for security analysis.</scenario>
      <question-text>Which Network Watcher features should you use?</question-text>
      <choices>
        <choice letter="A">IP flow verify for NSG testing, connection troubleshoot, and packet capture for analysis</choice>
        <choice letter="B">Azure Monitor metrics only</choice>
        <choice letter="C">Manual ping tests</choice>
        <choice letter="D">Firewall logs only</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Network Watcher provides IP flow verify, connection troubleshoot, and packet capture for network security analysis.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>IP flow verify tests whether traffic is allowed/denied by NSG rules. Connection troubleshoot diagnoses connectivity issues between Azure resources. Packet capture collects network traffic for deep analysis. NSG flow logs show all traffic decisions for security monitoring and compliance.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>IP flow verify: shows which NSG rule allowed/denied specific traffic.</li>
              <li>NSG flow logs: JSON logs of all NSG decisions; sent to storage or Log Analytics.</li>
              <li>Traffic Analytics: visualizes NSG flow logs with insights on traffic patterns.</li>
              <li>Connection Monitor: continuous connectivity testing and alerting.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Network Watcher</tag>
        <tag>Diagnostics</tag>
        <tag>Traffic Analysis</tag>
      </tags>
    </question>

    <question id="44" category-ref="cat-compute" difficulty="intermediate">
      <title>Function App Security</title>
      <scenario>Your Azure Functions process sensitive data. You need to secure the function app, protect secrets, and control network access.</scenario>
      <question-text>Which security configurations should you apply?</question-text>
      <choices>
        <choice letter="A">VNet integration, Key Vault references for secrets, managed identity, and function access keys</choice>
        <choice letter="B">Secrets in application settings</choice>
        <choice letter="C">Public endpoint without authentication</choice>
        <choice letter="D">Anonymous access for all functions</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>VNet integration isolates traffic; Key Vault protects secrets; managed identity eliminates credentials; access keys control invocation.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Enable VNet integration to access private resources and optionally restrict inbound access. Use Key Vault references in app settings instead of storing secrets directly. Enable managed identity for authenticating to Azure services. Configure function-level access keys (function/admin) or Easy Auth for human access.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Authorization levels: Anonymous, Function, Admin.</li>
              <li>Private Endpoints: fully private function app access.</li>
              <li>Deployment slots: separate keys, useful for blue-green deployments.</li>
              <li>IP restrictions: limit inbound to specific networks or services.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Function Security</tag>
        <tag>Serverless Security</tag>
        <tag>Key Vault</tag>
      </tags>
    </question>

    <question id="45" category-ref="cat-operations" difficulty="advanced">
      <title>Security Benchmarks</title>
      <scenario>Your organization needs to align Azure configurations with industry security standards and best practices.</scenario>
      <question-text>Which framework provides Azure-specific security best practices?</question-text>
      <choices>
        <choice letter="A">Microsoft Cloud Security Benchmark (MCSB) implemented via Defender for Cloud</choice>
        <choice letter="B">Generic security checklists</choice>
        <choice letter="C">Vendor-neutral frameworks only</choice>
        <choice letter="D">Custom security standards without industry alignment</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>MCSB provides Azure-specific security controls mapped to industry standards; Defender for Cloud assesses compliance.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Microsoft Cloud Security Benchmark (MCSB) provides Azure-specific security controls covering network, identity, data protection, and more. Controls map to CIS, NIST, and PCI-DSS. Defender for Cloud's default initiative assesses against MCSB and provides recommendations for remediation.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>MCSB v3: organized by security functions (Network, Identity, Data, etc.).</li>
              <li>Control domains: Network Security, Identity Management, Privileged Access, Data Protection, etc.</li>
              <li>Azure Security Benchmark is predecessor; MCSB is multi-cloud.</li>
              <li>CIS Azure Benchmarks provide additional hardening guidance.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Security Benchmark</tag>
        <tag>MCSB</tag>
        <tag>Compliance</tag>
      </tags>
    </question>

    <question id="46" category-ref="cat-identity" difficulty="advanced">
      <title>Token Protection</title>
      <scenario>Attackers have stolen access tokens and are using them from different devices. You need to prevent stolen token replay attacks.</scenario>
      <question-text>Which feature prevents stolen token replay?</question-text>
      <choices>
        <choice letter="A">Conditional Access token protection (token binding)</choice>
        <choice letter="B">Longer token lifetimes</choice>
        <choice letter="C">MFA for initial authentication only</choice>
        <choice letter="D">IP-based Conditional Access only</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Token protection binds tokens to the device, making stolen tokens unusable on other devices.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Conditional Access token protection (sign-in session token binding) cryptographically binds access tokens to the device's TPM. If an attacker steals the token and tries to use it from a different device, the token validation fails. This mitigates token theft attacks like pass-the-token.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Token protection requires Windows 10/11 with TPM and supported apps.</li>
              <li>Currently in preview; initially supports desktop Office apps.</li>
              <li>Continuous Access Evaluation (CAE) enables near real-time policy enforcement.</li>
              <li>Complements sign-in frequency and persistent browser controls.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Token Protection</tag>
        <tag>Token Theft</tag>
        <tag>Zero Trust</tag>
      </tags>
    </question>

    <question id="47" category-ref="cat-data" difficulty="intermediate">
      <title>Storage Access Tiers</title>
      <scenario>You need to securely archive audit logs for 7 years while minimizing storage costs and maintaining data protection.</scenario>
      <question-text>How should you configure storage for long-term retention?</question-text>
      <choices>
        <choice letter="A">Archive tier with immutability policy and access tiering automation</choice>
        <choice letter="B">Hot tier for all data</choice>
        <choice letter="C">Delete logs after one year</choice>
        <choice letter="D">Local storage without cloud backup</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Archive tier minimizes cost; immutability ensures data cannot be modified; lifecycle policies automate tiering.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Store long-term audit logs in Archive tier (~$0.002/GB/month). Apply time-based immutability policy to prevent modification or deletion for 7 years. Use lifecycle management rules to automatically move logs from Hot to Cool to Archive based on age. Retrieval requires rehydration.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Archive tier: lowest cost; up to 15 hours for standard retrieval.</li>
              <li>Immutability: WORM (Write Once, Read Many) for compliance.</li>
              <li>Legal hold: indefinite immutability for litigation preservation.</li>
              <li>Soft delete protects against accidental deletion during retention period.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Storage Tiers</tag>
        <tag>Data Retention</tag>
        <tag>Compliance</tag>
      </tags>
    </question>

    <question id="48" category-ref="cat-operations" difficulty="advanced">
      <title>Workbook Security Monitoring</title>
      <scenario>Your security team needs custom dashboards to visualize security data: identity risks, network threats, and compliance status.</scenario>
      <question-text>How should you create security visualizations?</question-text>
      <choices>
        <choice letter="A">Azure Workbooks with KQL queries against Sentinel and Defender data</choice>
        <choice letter="B">Export data to Excel for manual charting</choice>
        <choice letter="C">Default portal views only</choice>
        <choice letter="D">Third-party BI tools exclusively</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Azure Workbooks create interactive reports using KQL queries against Log Analytics and Sentinel data.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Azure Workbooks provide interactive reports and dashboards using KQL queries. Query data from Log Analytics, Sentinel, and Defender for Cloud. Combine visualizations (charts, grids, maps), parameters for filtering, and drill-down capabilities. Share workbooks across the team or organization.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Sentinel content hub includes pre-built workbooks for many data sources.</li>
              <li>Parameters enable interactive filtering without editing queries.</li>
              <li>Groups organize visualizations with tabs or accordions.</li>
              <li>Export to PDF or share via workbook templates.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Workbooks</tag>
        <tag>Security Dashboards</tag>
        <tag>KQL</tag>
      </tags>
    </question>

    <question id="49" category-ref="cat-network" difficulty="intermediate">
      <title>DNS Security</title>
      <scenario>You need to protect against DNS-based attacks and ensure DNS queries from your VNets are logged and monitored.</scenario>
      <question-text>How should you secure DNS in your Azure environment?</question-text>
      <choices>
        <choice letter="A">Azure Firewall DNS proxy with DNS logging and threat intelligence filtering</choice>
        <choice letter="B">Public DNS servers without filtering</choice>
        <choice letter="C">Custom DNS servers without logging</choice>
        <choice letter="D">Disable DNS resolution</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Azure Firewall DNS proxy inspects DNS queries, applies threat intelligence, and logs all resolutions.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Enable Azure Firewall DNS proxy to intercept all DNS queries from VNets. Configure custom DNS servers pointing to Azure Firewall. Threat intelligence filtering blocks queries to known malicious domains. DNS logs in Log Analytics enable monitoring for DNS tunneling or C2 communication.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Azure Firewall Premium: FQDN filtering in network rules requires DNS proxy.</li>
              <li>DNS logs show queried domains, source IPs, and resolutions.</li>
              <li>DNS threat intelligence: blocks domains flagged as malicious.</li>
              <li>Azure DNS Private Resolver provides hybrid DNS without custom VMs.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>DNS Security</tag>
        <tag>Azure Firewall</tag>
        <tag>Threat Intelligence</tag>
      </tags>
    </question>

    <question id="50" category-ref="cat-operations" difficulty="advanced">
      <title>Security Governance at Scale</title>
      <scenario>Your enterprise Azure environment spans multiple subscriptions. You need to enforce security policies consistently and report on compliance across the entire estate.</scenario>
      <question-text>How should you implement security governance at scale?</question-text>
      <choices>
        <choice letter="A">Management groups with Azure Policy initiatives, Defender for Cloud coverage, and centralized Sentinel</choice>
        <choice letter="B">Per-subscription security configuration</choice>
        <choice letter="C">Rely on individual team responsibility</choice>
        <choice letter="D">Annual security audits only</choice>
      </choices>
      <correct-answer>A</correct-answer>
      <hints>
        <hint level="1" label="Brief Hint">
          <content>Management groups apply policies across subscriptions; Defender provides posture; Sentinel centralizes security operations.</content>
        </hint>
        <hint level="2" label="Complete Explanation">
          <content>Organize subscriptions under management groups and assign Azure Policy security initiatives at the management group level for consistent enforcement. Enable Defender for Cloud across all subscriptions for unified security posture management. Centralize security logs in a single Sentinel workspace for unified threat detection and response.</content>
        </hint>
        <hint level="3" label="Deep Knowledge">
          <content>
            <ul>
              <li>Azure Landing Zone architecture provides governance foundation.</li>
              <li>Lighthouse enables MSP-style cross-tenant management.</li>
              <li>Continuous export sends Defender alerts to Sentinel automatically.</li>
              <li>Policy exemptions should be time-limited and tracked.</li>
            </ul>
          </content>
        </hint>
      </hints>
      <tags>
        <tag>Security Governance</tag>
        <tag>Enterprise Scale</tag>
        <tag>Policy</tag>
      </tags>
    </question>
  </questions>

  <glossary>
    <term id="gl-zero-trust" category="Security Model">
      <name>Zero Trust</name>
      <definition>Security model that assumes breach and verifies each request as though it originates from an untrusted network, enforcing least-privilege access.</definition>
      <exam-note>Key principles: verify explicitly, use least-privilege access, assume breach.</exam-note>
    </term>
    <term id="gl-conditional-access" category="Identity">
      <name>Conditional Access</name>
      <definition>Entra ID feature that enforces access policies based on conditions like user risk, device state, location, and application.</definition>
      <exam-note>Creates if-then policies; enables zero trust for identity.</exam-note>
    </term>
    <term id="gl-pim" category="Identity">
      <name>Privileged Identity Management</name>
      <definition>Azure AD service providing just-in-time privileged access with activation workflows, time limits, and audit trails.</definition>
      <exam-note>Reduces standing privileged access; requires Entra ID P2.</exam-note>
    </term>
    <term id="gl-defender-cloud" category="Operations">
      <name>Microsoft Defender for Cloud</name>
      <definition>Cloud security posture management (CSPM) and workload protection platform (CWPP) providing security recommendations and threat protection.</definition>
      <exam-note>Secure Score measures posture; Defender plans protect specific workloads.</exam-note>
    </term>
    <term id="gl-sentinel" category="Operations">
      <name>Microsoft Sentinel</name>
      <definition>Cloud-native SIEM and SOAR solution for threat detection, investigation, and automated response.</definition>
      <exam-note>Built on Log Analytics; uses KQL for queries; playbooks automate response.</exam-note>
    </term>
    <term id="gl-cmk" category="Data Protection">
      <name>Customer-Managed Keys</name>
      <definition>Encryption keys stored in customer's Key Vault, providing control over encryption key lifecycle for Azure services.</definition>
      <exam-note>Enables key rotation, revocation, and compliance with key management requirements.</exam-note>
    </term>
    <term id="gl-private-endpoint" category="Networking">
      <name>Private Endpoint</name>
      <definition>Network interface providing private IP access to PaaS services, eliminating public network exposure.</definition>
      <exam-note>Requires Private DNS zones for name resolution; disable public access on services.</exam-note>
    </term>
    <term id="gl-jit" category="Compute">
      <name>Just-in-Time VM Access</name>
      <definition>Defender for Cloud feature that blocks management ports by default and opens them temporarily upon approved request.</definition>
      <exam-note>Reduces attack surface; creates deny rules at priority 100.</exam-note>
    </term>
  </glossary>
</certification-exam>
